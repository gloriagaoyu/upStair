window.__require=function e(t,n,a){function i(o,s){if(!n[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+o+"'")}}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,a)}return n[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<a.length;o++)i(a[o]);return i}({rankList:[function(e,t,n){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","rankList"),cc.Class({extends:cc.Component,properties:{prefab:{default:null,type:cc.Prefab},content:{default:null,type:cc.Node},ownContent:{default:null,type:cc.Node},ownOpenid:0,maxShowPlayerRank:30},start:function(){var e=this;"undefined"!=typeof wx&&wx.onMessage(function(t){"updateScore"==t.message&&e.setMaxScoreToWx(t.score),"refresh"==t.message&&(e.ownContent.active=!1,e.initUserInfo(),e.initFriendInfo()),"destory"==t.message&&e.content.removeAllChildren()})},setMaxScoreToWx:function(e){wx.getUserCloudStorage({keyList:["score"],success:function(t){if(t.KVDataList.length>0&&t.KVDataList[0].value<e){var n=[{key:"score",value:String(e)}];wx.setUserCloudStorage({KVDataList:n,success:function(e){console.log(JSON.stringify(n))},fail:function(e){console.error(e)}})}}})},initUserInfo:function(){var e=this;wx.getUserInfo({openIdList:["selfOpenId"],lang:"zh_CN",success:function(t){e.ownOpenid=t.data[0].nickName||t.data[0].nickName||t.data[0].nickname},fail:function(e){console.error(e)}})},initFriendInfo:function(){var e=this;wx.getFriendCloudStorage({keyList:["score"],success:function(t){t.data.sort(function(e,t){var n=e.KVDataList&&e.KVDataList[0]&&e.KVDataList[0].value?e.KVDataList[0].value:0;return(t.KVDataList&&t.KVDataList[0]&&t.KVDataList[0].value?t.KVDataList[0].value:0)-n});for(var n=0;n<t.data.length;++n)e.createUserBlock(t.data[n],n)},fail:function(e){console.error(e)}})},createUserBlock:function(e,t){console.log(JSON.stringify(e));var n=cc.instantiate(this.prefab);n.parent=this.content,n.x=10,this.createImage(n.getChildByName("mask").getChildByName("userIcon").getComponent(cc.Sprite),e.avatarUrl);var a=n.getChildByName("userName").getComponent(cc.Label);a.string=e.nickName||e.nickName||e.nickname,n.getChildByName("rankIndex").getComponent(cc.Label).string=t+1;var i=n.getChildByName("score").getComponent(cc.Label);if(e.KVDataList&&e.KVDataList[0]&&e.KVDataList[0].value?i.string=e.KVDataList[0].value+"\u5206":i.string="0\u5206",a.string==this.ownOpenid){this.ownContent.x=10,this.createImage(this.ownContent.getChildByName("mask").getChildByName("userIcon").getComponent(cc.Sprite),e.avatarUrl),this.ownContent.getChildByName("userName").getComponent(cc.Label).string=e.nickName||e.nickName||e.nickname,this.ownContent.getChildByName("rankIndex").getComponent(cc.Label).string=t+1;var r=this.ownContent.getChildByName("score").getComponent(cc.Label);e.KVDataList&&e.KVDataList[0]&&e.KVDataList[0].value?r.string=e.KVDataList[0].value+"\u5206":r.string="0\u5206",this.ownContent.active=!0}},createImage:function(e,t){if(cc.sys.platform===cc.sys.WECHAT_GAME){var n=wx.createImage();n.onload=function(){var t=new cc.Texture2D;t.initWithElement(n),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t)},n.src=t}}}),cc._RF.pop()},{}]},{},["rankList"]);